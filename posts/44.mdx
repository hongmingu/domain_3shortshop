---
title: Flutter Dart 클로저 
description: "Flutter의 언어인 Dart의 클로저 개념을 알아보자"
date: August 4 2023
---
클로저는 특정 범위의 변수를 참조하는 함수로 해당 범위가 사라진 후에도 해당 변수의 참조를 유지한다. 
다트에서 클로저를 사용하면 함수가 그 함수가 정의된 범위 외부에서도 그 범위의 변수에 액세스할 수 있다.

```
Function makeAdder(int addBy) {
  return (int i) => addBy + i;
}

void main() {
  var add2 = makeAdder(2);
  var add4 = makeAdder(4);

  print(add2(3)); // 5 출력
  print(add4(3)); // 7 출력
}
```
makeAdder 함수는 내부 함수를 반환하는데 이 내부 함수는 makeAdder의 매개변수 addBy를 참조한다. 
add2와 add4는 이 내부 함수의 인스턴스이므로 addBy의 값에 따라 서로 다른 연산을 수행한다. 이러한 동작은 클로저 덕분에 가능하다.

플러터에서 클로저는 상태 관리 콜백 이벤트 처리 등 다양한 상황에서 유용하게 사용될 수 있다.

플러터(Flutter)와 다트(Dart)에서 클로저(closure)는 매우 중요한 역할을 하며 특히 상태 관리와 콜백에서 자주 사용된다. 
클로저는 특정 범위에서 생성된 로컬 변수에 대한 참조를 포착하고 이를 함수가 실행되는 다른 컨텍스트에서도 유지한다. 이를 통해 함수가 그것이 생성된 환경과 상호작용할 수 있게 해준다.


다음 예시를 통해 더 알아보자.
```
Function counter() {
  int count = 0;
  return () {
    print("Count is ${++count}");
  };
}

void main() {
  final incrementCounter = counter();
  incrementCounter(); // Count is 1 출력
  incrementCounter(); // Count is 2 출력
}
```
여기에서 counter 함수는 익명 함수를 반환하며 이 익명 함수는 외부 함수의 count 변수를 참조한다. 
incrementCounter를 호출할 때마다 count 변수의 값이 증가하며 이는 클로저가 count 변수의 참조를 계속 유지하고 있기 때문이다.

##플러터에서 클로저의 활용
플러터에서 클로저는 여러 가지 상황에서 활용될 수 있다.

### 상태 관리
플러터에서 상태 관리는 중요한 개념이다. 클로저를 사용하면 내부 상태를 포착하고 이를 다른 위젯과 공유할 수 있다.

### 콜백과 이벤트 핸들링
클로저를 이용하여 이벤트 핸들러를 생성할 수 있다. 예를 들어 버튼이 클릭될 때 호출되는 함수에서 특정 값을 참조하려면 클로저를 사용할 수 있다.

### 비동기 작업
클로저는 Future와 Stream과 같은 비동기 작업에서도 유용하게 사용될 수 있으며 비동기 작업의 결과를 처리하는 데 사용할 수 있다.


## 클로저의 내부 작동 원리
클로저는 함수와 해당 함수가 선언된 범위에서 접근 가능한 모든 변수를 포함한 환경의 조합이다. 클로저가 호출되면 해당 환경이 유지되므로 외부 스코프의 변수에 접근할 수 있다. 이를 통해 함수는 자신이 선언된 컨텍스트를 "기억"할 수 있게 된다.

### 메모리 관리
클로저가 변수에 대한 참조를 유지하므로 해당 변수는 가비지 컬렉션(GC)의 대상이 되지 않다. 이로 인해 메모리 누수가 발생할 가능성이 있으므로 클로저 사용시 주의가 필요하다.

### 상태 캡슐화
클로저를 사용하면 상태를 캡슐화하여 외부에서의 접근을 제한할 수 있다. 이를 통해 변수를 더 안전하게 관리할 수 있으며 오류 가능성을 줄일 수 있다.

### 클로저와 함수 리터럴
다트에서 익명 함수는 그 자체로 클로저이다. 외부 범위의 변수를 참조할 필요가 없더라도 해당 범위의 모든 변수에 대한 참조를 포함할 수 있다.

## 클로저와 비동기 프로그래밍
다트의 Future와 Stream과 같은 비동기 프로그래밍에서 클로저는 매우 중요하다. 클로저는 비동기 작업을 스케줄링하거나 콜백을 처리하는 데 사용될 수 있으며 이는 플러터의 비동기 작업 처리에 흔히 볼 수 있는 패턴이다.